#!/usr/bin/env tclkit
# simple tests to catch low-level problems

source [file join [file dir [info script]] initests.tcl]

# %renumber<^\s*test >%

test 0 {load extension} {
  package require ratcl
} 3

test 1 {view exists} -body {
  view
} -returnCodes error -result {wrong # args: should be "view v ... | ..."}

set v [view {A B C} vdef {1 2 3 11 22 33 111 222 333}]
set w [view {D E} vdef {a aa b bb c cc}]
  
test 2 {} {
  view $v names
} {A B C}

test 3 {} {
  view $v types
} {S S S}
  
test 4 {} {
  view $v width
} 3

test 5 {} {
  vget $v *
} {{1 2 3} {11 22 33} {111 222 333}}

test 6 {} {
  view $v first 2 
} {first {vdef {A B C} {1 2 3 11 22 33 111 222 333}} 2}

test 7 {} {
  view $v first 2 | names
} {A B C}

test 8 {} {
  view $v first 2 | get #
} 2

test 9 {} {
  view $v first 2 | get
} {1 2 3 11 22 33}

test 10 {} {
  view $v pair $w | names
} {A B C D E}

test 11 {} {
  view $v pair $w | get #
} 3

test 12 {} {
  view 5 tag N | get
} {0 1 2 3 4}

test 13 {} {
  view 5 get * #
} {0 1 2 3 4}

test 14 {} {
  view {5 2 3 4 1 8 0 9 6 7} asview N:I | sortmap
} {6 4 1 2 3 0 8 9 5 7}

::tcltest::cleanupTests
