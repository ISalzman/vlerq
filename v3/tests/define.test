#!/usr/bin/env tclkit
# view definition tests

source [file join [file dir [info script]] initests.tcl]

# %renumber<^\s*test >%

test 0 {load extension} {
  package require ratcl
} 3

test 1 {view exists} -body {
  view
} -returnCodes error -result {wrong # args: should be "view v ... | ..."}

test 2 {} { view {A B} vdef {1 2 3 4 5 6} | get #     } 3 
test 3 {} { view {A B} vdef {1 2 3 4 5 6} | get *     } {{1 2} {3 4} {5 6}} 
test 4 {} { view {A B} vdef {1 2 3 4 5 6} | get * *   } {1 2 3 4 5 6} 
test 5 {} { view {A B} vdef {1 2 3 4 5 6} | get @ #   } 2 
test 6 {} { view {A B} vdef {1 2 3 4 5 6} | get @ * 0 } {A B} 
test 7 {} { view {A B} vdef {1 2 3 4 5 6} | get @ *   } {{A S {}} {B S {}}}

test 8 {}  { view A vdef | get #     } 0
test 9 {}  { view A vdef | get @ #   } 1
test 10 {} { view A vdef | get @ * 0 } A
test 11 {} { view A vdef | get *     } {}
test 12 {} { view A vdef | get * *   } {}
  
test 13 {} { view {A B} vdef {1 2 3} {4 5 6} | get #     } 3 
test 14 {} { view {A B} vdef {1 2 3} {4 5 6} | get *     } {{1 4} {2 5} {3 6}} 
test 15 {} { view {A B} vdef {1 2 3} {4 5 6} | get * *   } {1 4 2 5 3 6} 
test 16 {} { view {A B} vdef {1 2 3} {4 5 6} | get @ #   } 2 
test 17 {} { view {A B} vdef {1 2 3} {4 5 6} | get @ * 0 } {A B} 
test 18 {} { view {A B} vdef {1 2 3} {4 5 6} | get @ *   } {{A S {}} {B S {}}}
  
::tcltest::cleanupTests
