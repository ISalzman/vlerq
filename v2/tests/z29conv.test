#!/usr/bin/tclsh
# z29conv.test -=- test suite for view conversions
# %renumber<^test >%

set uses {thrill ratcl}
source [file join [file dirname [info script]] initests.tcl]

test 0 {test view} {
  set v [vdef A B:s C:I D:i {a0 b0 0 0 a1 "" 1 "" a2 b2 2 2}]
  list [view $v info tag] [view $v info names] [view $v get]
} {row {A B C D} {a0 b0 0 0 a1 {} 1 {} a2 b2 2 2}}

test 1 {freeze as columns} {
  set w [view $v freeze]
  list [view $w info tag] [view $w info names] [view $w get]
} {col {A B C D} {a0 b0 0 0 a1 {} 1 {} a2 b2 2 2}}

test 2 {test subviews} {
  set v [vdef A {B {C D}} {a {b c} d {e f g h} i {j k}}]
  list [view $v info tag] [view $v info names] [view $v get 1 1 | info tag]
} {row {A B} row}

test 3 {freeze as columns, recursively} {
  set w [view $v freeze]
  list [view $w info tag] [view $w info names] [view $w get 1 1 | info tag]
} {col {A B} col}

test 4 {freeze again is harmless} {
  set w [view $w freeze]
  list [view $w info tag] [view $w info names] [view $w get 1 1 | info tag]
} {col {A B} col}

test 5 {data stack is empty} {
  vfinish
} {}

cleanupTests

# vim: set ft=tcl :
