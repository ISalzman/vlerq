#!/usr/bin/env tclkit
# %renumber<^\s*test >%

source [file join [file dir [info script]] initests.tcl]

test 0 {load ratcl package} {
    package require ratcl
} $version

test 1 {display a meta-view} {
    tvq dump {A,B[C:I],D:s}
} { \
  name  type  subv
  ----  ----  ----
  A        5    #0
  B        7    #1
  D       21    #0}

test 2 {create and display an empty view} {
    tvq dump {view 0 {A,B[C:I],D:s}}
} { \
  A  B  D
  -  -  -}

test 3 {create and display a view with no data} {
    tvq dump {view 2 {A,B[C:I],D:s}}
} { \
  A  B   D
  -  --  -
     #0   
     #0   }

test 4 {} {
    tvq dump [tvq meta {A,B[C:I],D:s}]
} { \
  name  type  subv
  ----  ----  ----
  name     5    #0
  type     1    #0
  subv     7    #0}

test 5 {} -body {
    tvq view {meta {A,B[C:I],D:s}}
} -match glob -result {tvqobj 0x*}

test 6 {} {
    tvq dump {meta {A,B[C:I],D:s}}
} { \
  name  type  subv
  ----  ----  ----
  name     5    #0
  type     1    #0
  subv     7    #0}

test 7 {} {
    tvq struct {open ../data/alltypes.db}
} (IIIIIIILFDSB)

test 8 {} {
    tvq dump {at {open ../data/simple.db} 0 0}
} { \
  abc  
  -----
      1
     22
    333
   4444
  55555}

::tcltest::cleanupTests
